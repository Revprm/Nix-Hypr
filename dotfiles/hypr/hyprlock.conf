# Improved Tokyo Night Hyprlock - No Overlaps, Better Spacing
# Backup your existing file before replacing.

source = $HOME/.config/hypr/wallust/wallust-hyprland.conf
$Scripts = $HOME/.config/hypr/scripts

general {
    grace = 1
    fractional_scaling = 2
    immediate_render = true
}

background {
    monitor =
    path = $HOME/.config/hypr/wallpaper_effects/.wallpaper_current
    color = $background
    blur_size = 4
    blur_passes = 3
    noise = 0.015
    contrast = 1.2
    brightness = 0.85
    vibrancy = 0.15
    vibrancy_darkness = 0.05
}

# ---------- Main Clock: Large HH:MM:SS ----------
label {
    monitor =
    text = cmd[update:1000] echo "$(date +'%H:%M:%S')"
    color = $foreground
    font_size = 140
    font_family = "JetBrains Mono ExtraBold"
    position = 0, 80
    halign = center
    valign = center
}

# ---------- Date: Below clock with proper spacing ----------
label {
    monitor =
    text = cmd[update:18000000] echo "<b>$(date +'%A, %-d %B %Y')</b>"
    color = rgba(255,255,255,0.8)
    font_size = 20
    font_family = "JetBrains Mono Medium"
    position = 0, -20
    halign = center
    valign = center
}

# ---------- Input Field: Well spaced below date ----------
input-field {
    monitor =
    size = 450, 70
    outline_thickness = 2
    dots_size = 0.2
    dots_spacing = 0.2
    dots_center = true
    dots_rounding = -1
    outer_color = $color13
    inner_color = rgba(0,0,0,0.2)
    font_color = $foreground
    capslock_color = $color1
    fade_on_empty = false
    fade_timeout = 2000
    font_family = "JetBrains Mono Medium"
    font_size = 16
    placeholder_text = <i><span foreground="##ffffff77">[LOCK] Enter Password</span></i>
    hide_input = false
    rounding = 12
    shadow_passes = 3
    shadow_size = 5
    shadow_color = rgba(0,0,0,0.3)
    position = 0, -120
    halign = center
    valign = center
}

# ---------- Username: Below input with spacing ----------
label {
    monitor =
    text = ">> $USER"
    color = $color7
    font_size = 16
    font_family = "JetBrains Mono Medium"
    position = 0, -200
    halign = center
    valign = center
}

# ---------- Top Status Bar: System Info ----------
# Hostname/System - Top Left
label {
    monitor =
    text = cmd[update:30000] echo "[SYS] $(hostname)"
    color = rgba(255,255,255,0.7)
    font_size = 12
    font_family = "JetBrains Mono"
    position = 30, -30
    halign = left
    valign = top
}

# Date/Time Info - Top Right
label {
    monitor =
    text = cmd[update:1000] echo "$(date +'%Z • Week %V')"
    color = rgba(255,255,255,0.6)
    font_size = 12
    font_family = "JetBrains Mono"
    position = -30, -30
    halign = right
    valign = top
}

# ---------- Bottom Left Status Group ----------
# Weather - Bottom Left Primary
label {
    monitor =
    text = cmd[update:3600000] [ -f "$HOME/.cache/.weather_cache" ] && echo "[WTR] $(cat "$HOME/.cache/.weather_cache")" || echo "[WTR] Weather: Unavailable"
    color = rgba(255,255,255,0.8)
    font_size = 14
    font_family = "JetBrains Mono Medium"
    position = 30, 80
    halign = left
    valign = bottom
}

# Uptime - Bottom Left Secondary
label {
    monitor =
    text = cmd[update:60000] echo "[UPT] $(uptime -p | sed 's/up //' || $Scripts/UptimeNixOS.sh)"
    color = rgba(255,255,255,0.6)
    font_size = 12
    font_family = "JetBrains Mono"
    position = 30, 50
    halign = left
    valign = bottom
}

# ---------- Bottom Right Status Group ----------
# Battery - Bottom Right Primary
label {
    monitor =
    text = cmd[update:5000] echo "[BAT] $($Scripts/Battery.sh 2>/dev/null | head -1 || echo 'N/A')"
    color = rgba(255,255,255,0.8)
    font_size = 14
    font_family = "JetBrains Mono Medium"
    position = -30, 80
    halign = right
    valign = bottom
}

# Memory Usage - Bottom Right Secondary
label {
    monitor =
    text = cmd[update:5000] echo "[MEM] $(free -h | awk '/^Mem:/ {printf "%.0f%%", ($3/$2)*100}')"
    color = rgba(255,255,255,0.6)
    font_size = 12
    font_family = "JetBrains Mono"
    position = -30, 50
    halign = right
    valign = bottom
}

# CPU Usage - Bottom Right Tertiary
label {
    monitor =
    text = cmd[update:3000] echo "[CPU] $(top -bn1 | grep "Cpu(s)" | awk '{print $2}' | cut -d'%' -f1 | head -1)% CPU"
    color = rgba(255,255,255,0.5)
    font_size = 11
    font_family = "JetBrains Mono"
    position = -30, 20
    halign = right
    valign = bottom
}

# ---------- Decorative Elements ----------
# Subtle separator line above bottom info
label {
    monitor =
    text = "────────────────────────────────────────────────────────────────────────"
    color = rgba(255,255,255,0.1)
    font_size = 8
    font_family = "JetBrains Mono"
    position = 0, 110
    halign = center
    valign = bottom
}